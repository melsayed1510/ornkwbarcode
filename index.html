<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>ORN Kw - Barcode Maker</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Barcode + ZIP -->
<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

<style>
  body{background:#f5f7fa;padding:30px;}
  footer img{
    width:22px;
    filter:invert(1) brightness(2);
    transition:0.2s;
  }
  footer img:hover{transform:scale(1.15);}
  .card svg{max-width:100%;}
  footer{background:#222;color:#fff;}
</style>
</head>

<body class="text-center">

<!-- Language Bar -->
<div class="container mb-3">
  <div class="d-flex justify-content-start">
    <button id="langBtn" class="btn btn-dark btn-sm" onclick="toggleLang()">English</button>
  </div>
</div>

<!-- Main Content -->
<div class="container bg-white shadow rounded p-4">

  <h2 id="mainTitle" class="text-primary mb-2">Ù…ÙˆÙ„Ø¯ Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ø´Ø±ÙƒØ© ORN Kw</h2>

  <a href="https://ornkw.com" target="_blank" class="btn btn-warning fw-bold mb-3">ğŸŒ www.ornkw.com</a>

  <h5 id="subtitle">Ø£Ø¯Ø®Ù„ Ø£Ø±Ù‚Ø§Ù… (Ø±Ù‚Ù… ÙÙŠ ÙƒÙ„ Ø³Ø·Ø±)</h5>

  <textarea id="input" class="form-control my-2" rows="5"></textarea>

  <div class="d-flex justify-content-center gap-2 my-3 flex-wrap">
    <button id="btnGen" class="btn btn-primary" onclick="generate()">ØªÙˆÙ„ÙŠØ¯</button>
    <button id="btnZip" class="btn btn-secondary" onclick="downloadAll()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙ„</button>
  </div>

  <div id="status" class="fw-bold text-dark mb-2"></div>

  <!-- Output -->
  <div id="output" class="row g-3"></div>
</div>

<!-- Footer -->
<footer class="container rounded mt-4 p-2 d-flex justify-content-between align-items-center flex-wrap">
  <div class="fw-bold opacity-75 small">Â© Mohamed Elsayed</div>
  <div class="d-flex gap-2 align-items-center">
    <a href="https://www.facebook.com/mohamed.elsayed.mtwaly/" target="_blank">
      <img src="https://cdn-icons-png.flaticon.com/512/733/733547.png" alt="">
    </a>
    <a href="https://www.instagram.com/m.elsayed1510/" target="_blank">
      <img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png" alt="">
    </a>
  </div>
</footer>

<script>
let lastSVGs=[], expectedCount=0, lang="ar";
let lastStatusKey="", lastStatusArgs=[];

const txt={
 ar:{title:"Ù…ÙˆÙ„Ø¯ Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ø´Ø±ÙƒØ© ORN Kw",sub:"Ø£Ø¯Ø®Ù„ Ø£Ø±Ù‚Ø§Ù… (Ø±Ù‚Ù… ÙÙŠ ÙƒÙ„ Ø³Ø·Ø±)",
     generate:"ØªÙˆÙ„ÙŠØ¯",zip:"ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙ„",download:"ØªØ­Ù…ÙŠÙ„",
     generated:"ØªÙ… ØªÙˆÙ„ÙŠØ¯",from:"Ù…Ù†",
     none:"Ù„Ù… ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø£ÙŠ Ø¨Ø§Ø±ÙƒÙˆØ¯",fail:"ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙ„.. ÙŠÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡",
     allgood:"Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ø§Ù„ØªØ­Ù…ÙŠÙ„..."},
 en:{title:"ORN Kw Products Barcode Generator",sub:"Enter codes (one per line)",
     generate:"Generate",zip:"Download All",download:"Download",
     generated:"Generated",from:"of",
     none:"No barcodes generated",fail:"Can't download â€” some failed",
     allgood:"Preparing download..."}
};

function setStatus(key,...args){
  lastStatusKey=key; lastStatusArgs=args;
  const st=document.getElementById("status");
  switch(key){
    case"generated":st.innerText=`${txt[lang].generated} ${args[0]} ${txt[lang].from} ${args[1]}`;break;
    case"none":st.innerText=txt[lang].none;break;
    case"fail":st.innerText=txt[lang].fail;break;
    case"allgood":st.innerText=txt[lang].allgood;break;
    case"done":st.innerText=lang==="ar"?"âœ”ï¸ ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­":"âœ”ï¸ Download started";break;
    default:st.innerText="";
  }
}

function setUI(){
 document.body.style.direction=lang==="ar"?"rtl":"ltr";
 document.getElementById("mainTitle").innerText=txt[lang].title;
 document.getElementById("subtitle").innerText=txt[lang].sub;
 document.getElementById("btnGen").innerText=txt[lang].generate;
 document.getElementById("btnZip").innerText=txt[lang].zip;
 document.getElementById("langBtn").innerText=lang==="ar"?"English":"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©";
 if(lastStatusKey)setStatus(lastStatusKey,...lastStatusArgs);
}

function toggleLang(){lang=lang==="ar"?"en":"ar";setUI();}

function generate(){
 const output=document.getElementById("output");
 output.innerHTML=""; lastSVGs=[];
 let lines=document.getElementById("input").value.split("\n").map(x=>x.trim()).filter(x=>x);
 lines=[...new Set(lines)]; expectedCount=lines.length;
 let counter=1;
 lines.forEach(text=>{
  const col=document.createElement("div");
  col.className="col-12 col-md-6 col-lg-4";
  const svg=document.createElementNS("http://www.w3.org/2000/svg","svg");
  try{
    JsBarcode(svg,text,{format:"CODE128",width:2,height:60,displayValue:true});
    const btn=`<button class="btn btn-sm btn-primary mt-2">${txt[lang].download} ${text}</button>`;
    let card=document.createElement("div");
    card.className="border rounded p-2";
    card.append(`${counter}. `);
    card.appendChild(svg);
    let b=document.createElement("button");
    b.className="btn btn-sm btn-primary mt-2";
    b.innerText=`${txt[lang].download} ${text}`;
    b.onclick=()=>downloadOne(svg,text);
    card.append(b);
    col.append(card);
    output.append(col);
    lastSVGs.push({svg,text});
    counter++;
  }catch(e){}
 });
 setStatus(lastSVGs.length>0?"generated":"none",lastSVGs.length,expectedCount);
}

function downloadOne(svg,text){
 const xml=new XMLSerializer().serializeToString(svg);
 const a=document.createElement("a");
 a.download=text+".svg";
 a.href="data:image/svg+xml;base64,"+btoa(xml);
 a.click();
}

async function downloadAll(){
 if(lastSVGs.length===0){setStatus("none");return;}
 if(lastSVGs.length!==expectedCount){setStatus("fail");return;}
 setStatus("allgood");
 const zip=new JSZip();
 lastSVGs.forEach(({svg,text})=>zip.file(`${text}.svg`,new XMLSerializer().serializeToString(svg)));
 saveAs(await zip.generateAsync({type:"blob"}),"ORNBARCODES.zip");
 setStatus("done");
 setTimeout(()=>{setStatus("")},4000);
}

setUI();
</script>
</body>
</html>
